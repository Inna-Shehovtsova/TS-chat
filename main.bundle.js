/*! For license information please see main.bundle.js.LICENSE.txt */
(()=>{"use strict";function e(e){return`Minified Redux error #${e}; visit https://redux.js.org/Errors?code=${e} for the full message or use the non-minified dev environment for full errors. `}var t=(()=>"function"==typeof Symbol&&Symbol.observable||"@@observable")(),r=()=>Math.random().toString(36).substring(7).split("").join("."),n={INIT:`@@redux/INIT${r()}`,REPLACE:`@@redux/REPLACE${r()}`,PROBE_UNKNOWN_ACTION:()=>`@@redux/PROBE_UNKNOWN_ACTION${r()}`};function o(e){if("object"!=typeof e||null===e)return!1;let t=e;for(;null!==Object.getPrototypeOf(t);)t=Object.getPrototypeOf(t);return Object.getPrototypeOf(e)===t||null===Object.getPrototypeOf(e)}function i(r,a,c){if("function"!=typeof r)throw new Error(e(2));if("function"==typeof a&&"function"==typeof c||"function"==typeof c&&"function"==typeof arguments[3])throw new Error(e(0));if("function"==typeof a&&void 0===c&&(c=a,a=void 0),void 0!==c){if("function"!=typeof c)throw new Error(e(1));return c(i)(r,a)}let s=r,u=a,l=new Map,f=l,h=0,p=!1;function d(){f===l&&(f=new Map,l.forEach(((e,t)=>{f.set(t,e)})))}function y(){if(p)throw new Error(e(3));return u}function m(t){if("function"!=typeof t)throw new Error(e(4));if(p)throw new Error(e(5));let r=!0;d();const n=h++;return f.set(n,t),function(){if(r){if(p)throw new Error(e(6));r=!1,d(),f.delete(n),l=null}}}function v(t){if(!o(t))throw new Error(e(7));if(void 0===t.type)throw new Error(e(8));if("string"!=typeof t.type)throw new Error(e(17));if(p)throw new Error(e(9));try{p=!0,u=s(u,t)}finally{p=!1}return(l=f).forEach((e=>{e()})),t}return v({type:n.INIT}),{dispatch:v,subscribe:m,getState:y,replaceReducer:function(t){if("function"!=typeof t)throw new Error(e(10));s=t,v({type:n.REPLACE})},[t]:function(){const r=m;return{subscribe(t){if("object"!=typeof t||null===t)throw new Error(e(11));function n(){const e=t;e.next&&e.next(y())}return n(),{unsubscribe:r(n)}},[t](){return this}}}}}function a(t){const r=Object.keys(t),o={};for(let e=0;e<r.length;e++){const n=r[e];"function"==typeof t[n]&&(o[n]=t[n])}const i=Object.keys(o);let a;try{!function(t){Object.keys(t).forEach((r=>{const o=t[r];if(void 0===o(void 0,{type:n.INIT}))throw new Error(e(12));if(void 0===o(void 0,{type:n.PROBE_UNKNOWN_ACTION()}))throw new Error(e(13))}))}(o)}catch(e){a=e}return function(t={},r){if(a)throw a;let n=!1;const c={};for(let a=0;a<i.length;a++){const s=i[a],u=o[s],l=t[s],f=u(l,r);if(void 0===f)throw r&&r.type,new Error(e(14));c[s]=f,n=n||f!==l}return n=n||i.length!==Object.keys(t).length,n?c:t}}function c(...e){return 0===e.length?e=>e:1===e.length?e[0]:e.reduce(((e,t)=>(...r)=>e(t(...r))))}var s={message:"",now:Date.now(),name:""},u="REQUEST_MESSAGES",l="RECEIVE_MESSAGES",f="RECEIVE_USERS",h="BEGIN_TYPE_MESSAGE",p="END_SEND_MESSAGE",d="END_TYPE_MESSAGE";function y(e,t,r){return{type:l,theme:e,messages:t,receivedAt:Date.now(),newM:r}}function m(e){return{type:h,message:e}}function v(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=Array(t);r<t;r++)n[r]=e[r];return n}var g=[{symb:":-)",html:"&#128512;"},{symb:"=)",html:"&#128512;"},{symb:":-D",html:"&#128515;"},{symb:":-(",html:"&#128545;"},{symb:"*O*",html:"&#128525;"},{symb:"XD",html:"&#128518;"},{symb:":-|",html:"&#129300;"},{symb:":-/",html:"&#128533;"},{symb:":O",html:"&#128565;"}];function b(e){return b="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},b(e)}function w(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function E(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?w(Object(r),!0).forEach((function(t){S(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):w(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function S(e,t,r){return(t=function(e){var t=function(e){if("object"!=b(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var r=t.call(e,"string");if("object"!=b(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==b(t)?t:t+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var O={delay:3,messages:{isFetching:!1,didInvalidate:!1,items:[]},isSend:!0},j={delay:3,users:{isFetching:!1,didInvalidate:!1,items:[]}},_={isFetching:!1,didInvalidate:!1,items:[]},L={isFetching:!1,didInvalidate:!1,items:[]},x=a({message:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:O,t=arguments.length>1?arguments[1]:void 0;switch(E({},e),t.type){case"SET_STORAGE":return E(E({},e),{},{messageStorage:t.storage});case"REQUEST_MESSAGE":var r,n=null!==(r=t.id)&&void 0!==r?r:0,o=Object.assign({},_);return o.isFetching=!0,o.didInvalidate=!1,E(E({},e),{},{messages:o,selectedID:n});case h:var i,a={isSend:!1,message:null!==(i=t.message)&&void 0!==i?i:s,error:"",isTyping:!0};return E(E({},e),{},{messageSend:a,isSend:!1});case d:var c,u={isSend:!1,message:null!==(c=t.message)&&void 0!==c?c:s,error:"",isTyping:!1};return E(E({},e),{},{messageSend:u,isSend:!1});case p:var l,f={isSend:!0,message:null!==(l=t.message)&&void 0!==l?l:s,error:"",isTyping:!1};return E(E({},e),{},{messageSend:f,isSend:!0});case"REQUEST_MESSAGES":var y,m=null!==(y=t.theme)&&void 0!==y?y:"",b=Object.assign({},e.messages);return b.isFetching=!0,b.didInvalidate=!1,E(E({},e),{},{messages:b,selectTheme:m});case"RECEIVE_MESSAGES":case"RECEIVE_ERROR":var w,S,j,L,x=null!==(w=t.theme)&&void 0!==w?w:"",P=null!==(S=t.receivedAt)&&void 0!==S?S:Date.now(),T=null!==(j=t.messages)&&void 0!==j?j:[],A=null!==(L=t.error)&&void 0!==L?L:"",N=t.id,I=Object.assign({},e.messages,{lastUpdated:P,items:T,error:A});return I.isFetching=!1,E(E({},e),{},{messages:I,selectTheme:x,selectedID:N});case"APPLY_SMILE":var D,k=null!==(D=t.message)&&void 0!==D?D:s;k.message=function(e){var t,r=e,n=function(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=function(e,t){if(e){if("string"==typeof e)return v(e,t);var r={}.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?v(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0,o=function(){};return{s:o,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,a=!0,c=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return a=e.done,e},e:function(e){c=!0,i=e},f:function(){try{a||null==r.return||r.return()}finally{if(c)throw i}}}}(g);try{for(n.s();!(t=n.n()).done;){var o=t.value;r=r.replace(o.symb,o.html)}}catch(e){n.e(e)}finally{n.f()}return r}(null==k?void 0:k.message);var R={isSend:!0,message:k,error:""};return E(E({},e),{},{messageSend:R});default:return e}},users:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:j,t=arguments.length>1?arguments[1]:void 0;switch(E({},e),t.type){case"REQUEST_USERS":t.theme;var r=Object.assign({},L);return r.isFetching=!0,E(E({},e),{},{users:r});case"RECEIVE_USERS":case"RECEIVE_ERROR_USER":var n,o,i,a=null!==(n=t.receivedAt)&&void 0!==n?n:Date.now(),c=null!==(o=t.items)&&void 0!==o?o:[],s=null!==(i=t.error)&&void 0!==i?i:"",u=Object.assign({},L,{lastUpdated:a,items:c,error:s,isFetching:!1});return E(E({},e),{},{users:u});default:return e}}});function P(e){return({dispatch:t,getState:r})=>n=>o=>"function"==typeof o?o(t,r,e):n(o)}var T=P(),A=P,N="undefined"!=typeof window&&window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__?window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__:function(){if(0!==arguments.length)return"object"==typeof arguments[0]?c:c.apply(null,arguments)};"undefined"!=typeof window&&window.__REDUX_DEVTOOLS_EXTENSION__&&window.__REDUX_DEVTOOLS_EXTENSION__;var I=class e extends Array{constructor(...t){super(...t),Object.setPrototypeOf(this,e.prototype)}static get[Symbol.species](){return e}concat(...e){return super.concat.apply(this,e)}prepend(...t){return 1===t.length&&Array.isArray(t[0])?new e(...t[0].concat(this)):new e(...t.concat(this))}},D=e=>t=>{setTimeout(t,e)},k="undefined"!=typeof window&&window.requestAnimationFrame?window.requestAnimationFrame:D(10),{assign:R}=Object;function M(e){return M="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},M(e)}function q(){q=function(){return t};var e,t={},r=Object.prototype,n=r.hasOwnProperty,o=Object.defineProperty||function(e,t,r){e[t]=r.value},i="function"==typeof Symbol?Symbol:{},a=i.iterator||"@@iterator",c=i.asyncIterator||"@@asyncIterator",s=i.toStringTag||"@@toStringTag";function u(e,t,r){return Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{u({},"")}catch(e){u=function(e,t,r){return e[t]=r}}function l(e,t,r,n){var i=t&&t.prototype instanceof v?t:v,a=Object.create(i.prototype),c=new A(n||[]);return o(a,"_invoke",{value:L(e,r,c)}),a}function f(e,t,r){try{return{type:"normal",arg:e.call(t,r)}}catch(e){return{type:"throw",arg:e}}}t.wrap=l;var h="suspendedStart",p="suspendedYield",d="executing",y="completed",m={};function v(){}function g(){}function b(){}var w={};u(w,a,(function(){return this}));var E=Object.getPrototypeOf,S=E&&E(E(N([])));S&&S!==r&&n.call(S,a)&&(w=S);var O=b.prototype=v.prototype=Object.create(w);function j(e){["next","throw","return"].forEach((function(t){u(e,t,(function(e){return this._invoke(t,e)}))}))}function _(e,t){function r(o,i,a,c){var s=f(e[o],e,i);if("throw"!==s.type){var u=s.arg,l=u.value;return l&&"object"==M(l)&&n.call(l,"__await")?t.resolve(l.__await).then((function(e){r("next",e,a,c)}),(function(e){r("throw",e,a,c)})):t.resolve(l).then((function(e){u.value=e,a(u)}),(function(e){return r("throw",e,a,c)}))}c(s.arg)}var i;o(this,"_invoke",{value:function(e,n){function o(){return new t((function(t,o){r(e,n,t,o)}))}return i=i?i.then(o,o):o()}})}function L(t,r,n){var o=h;return function(i,a){if(o===d)throw Error("Generator is already running");if(o===y){if("throw"===i)throw a;return{value:e,done:!0}}for(n.method=i,n.arg=a;;){var c=n.delegate;if(c){var s=x(c,n);if(s){if(s===m)continue;return s}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(o===h)throw o=y,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o=d;var u=f(t,r,n);if("normal"===u.type){if(o=n.done?y:p,u.arg===m)continue;return{value:u.arg,done:n.done}}"throw"===u.type&&(o=y,n.method="throw",n.arg=u.arg)}}}function x(t,r){var n=r.method,o=t.iterator[n];if(o===e)return r.delegate=null,"throw"===n&&t.iterator.return&&(r.method="return",r.arg=e,x(t,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),m;var i=f(o,t.iterator,r.arg);if("throw"===i.type)return r.method="throw",r.arg=i.arg,r.delegate=null,m;var a=i.arg;return a?a.done?(r[t.resultName]=a.value,r.next=t.nextLoc,"return"!==r.method&&(r.method="next",r.arg=e),r.delegate=null,m):a:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,m)}function P(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function T(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function A(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(P,this),this.reset(!0)}function N(t){if(t||""===t){var r=t[a];if(r)return r.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var o=-1,i=function r(){for(;++o<t.length;)if(n.call(t,o))return r.value=t[o],r.done=!1,r;return r.value=e,r.done=!0,r};return i.next=i}}throw new TypeError(M(t)+" is not iterable")}return g.prototype=b,o(O,"constructor",{value:b,configurable:!0}),o(b,"constructor",{value:g,configurable:!0}),g.displayName=u(b,s,"GeneratorFunction"),t.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===g||"GeneratorFunction"===(t.displayName||t.name))},t.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,b):(e.__proto__=b,u(e,s,"GeneratorFunction")),e.prototype=Object.create(O),e},t.awrap=function(e){return{__await:e}},j(_.prototype),u(_.prototype,c,(function(){return this})),t.AsyncIterator=_,t.async=function(e,r,n,o,i){void 0===i&&(i=Promise);var a=new _(l(e,r,n,o),i);return t.isGeneratorFunction(r)?a:a.next().then((function(e){return e.done?e.value:a.next()}))},j(O),u(O,s,"Generator"),u(O,a,(function(){return this})),u(O,"toString",(function(){return"[object Generator]"})),t.keys=function(e){var t=Object(e),r=[];for(var n in t)r.push(n);return r.reverse(),function e(){for(;r.length;){var n=r.pop();if(n in t)return e.value=n,e.done=!1,e}return e.done=!0,e}},t.values=N,A.prototype={constructor:A,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=e,this.done=!1,this.delegate=null,this.method="next",this.arg=e,this.tryEntries.forEach(T),!t)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=e)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var r=this;function o(n,o){return c.type="throw",c.arg=t,r.next=n,o&&(r.method="next",r.arg=e),!!o}for(var i=this.tryEntries.length-1;i>=0;--i){var a=this.tryEntries[i],c=a.completion;if("root"===a.tryLoc)return o("end");if(a.tryLoc<=this.prev){var s=n.call(a,"catchLoc"),u=n.call(a,"finallyLoc");if(s&&u){if(this.prev<a.catchLoc)return o(a.catchLoc,!0);if(this.prev<a.finallyLoc)return o(a.finallyLoc)}else if(s){if(this.prev<a.catchLoc)return o(a.catchLoc,!0)}else{if(!u)throw Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return o(a.finallyLoc)}}}},abrupt:function(e,t){for(var r=this.tryEntries.length-1;r>=0;--r){var o=this.tryEntries[r];if(o.tryLoc<=this.prev&&n.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var i=o;break}}i&&("break"===e||"continue"===e)&&i.tryLoc<=t&&t<=i.finallyLoc&&(i=null);var a=i?i.completion:{};return a.type=e,a.arg=t,i?(this.method="next",this.next=i.finallyLoc,m):this.complete(a)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),m},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.finallyLoc===e)return this.complete(r.completion,r.afterLoc),T(r),m}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.tryLoc===e){var n=r.completion;if("throw"===n.type){var o=n.arg;T(r)}return o}}throw Error("illegal catch attempt")},delegateYield:function(t,r,n){return this.delegate={iterator:N(t),resultName:r,nextLoc:n},"next"===this.method&&(this.arg=e),m}},t}function C(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function G(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?C(Object(r),!0).forEach((function(t){U(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):C(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function U(e,t,r){return(t=function(e){var t=function(e){if("object"!=M(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var r=t.call(e,"string");if("object"!=M(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==M(t)?t:t+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function F(e,t,r,n,o,i,a){try{var c=e[i](a),s=c.value}catch(e){return void r(e)}c.done?t(s):Promise.resolve(s).then(n,o)}function H(e){return function(){var t=this,r=arguments;return new Promise((function(n,o){var i=e.apply(t,r);function a(e){F(i,n,o,a,c,"next",e)}function c(e){F(i,n,o,a,c,"throw",e)}a(void 0)}))}}Symbol.for("rtk-state-proxy-original");var B={firebaseBaseUrl:"https://otus-js-chat-4ed79-default-rtdb.firebaseio.com",firebaseCollection:"messages.json"};function X(){return V.apply(this,arguments)}function V(){return V=H(q().mark((function e(){return q().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",fetch("".concat(B.firebaseBaseUrl,"/").concat(B.firebaseCollection),{headers:{Accept:"application/json","Content-Type":"application/json"}}).then((function(e){return e.json()})).then((function(e){return Object.values(e).map((function(e){return G(G({},e),{},{date:new Date(e.date)})}))})));case 1:case"end":return e.stop()}}),e)}))),V.apply(this,arguments)}function $(e){return Y.apply(this,arguments)}function Y(){return(Y=H(q().mark((function e(t){return q().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",fetch("".concat(B.firebaseBaseUrl,"/").concat(B.firebaseCollection),{method:"POST",body:JSON.stringify(G(G({},t),{},{date:new Date})),headers:{Accept:"application/json","Content-Type":"application/json"}}).then((function(e){return e.json()})));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function W(e){return W="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},W(e)}function K(){K=function(){return t};var e,t={},r=Object.prototype,n=r.hasOwnProperty,o=Object.defineProperty||function(e,t,r){e[t]=r.value},i="function"==typeof Symbol?Symbol:{},a=i.iterator||"@@iterator",c=i.asyncIterator||"@@asyncIterator",s=i.toStringTag||"@@toStringTag";function u(e,t,r){return Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{u({},"")}catch(e){u=function(e,t,r){return e[t]=r}}function l(e,t,r,n){var i=t&&t.prototype instanceof v?t:v,a=Object.create(i.prototype),c=new A(n||[]);return o(a,"_invoke",{value:L(e,r,c)}),a}function f(e,t,r){try{return{type:"normal",arg:e.call(t,r)}}catch(e){return{type:"throw",arg:e}}}t.wrap=l;var h="suspendedStart",p="suspendedYield",d="executing",y="completed",m={};function v(){}function g(){}function b(){}var w={};u(w,a,(function(){return this}));var E=Object.getPrototypeOf,S=E&&E(E(N([])));S&&S!==r&&n.call(S,a)&&(w=S);var O=b.prototype=v.prototype=Object.create(w);function j(e){["next","throw","return"].forEach((function(t){u(e,t,(function(e){return this._invoke(t,e)}))}))}function _(e,t){function r(o,i,a,c){var s=f(e[o],e,i);if("throw"!==s.type){var u=s.arg,l=u.value;return l&&"object"==W(l)&&n.call(l,"__await")?t.resolve(l.__await).then((function(e){r("next",e,a,c)}),(function(e){r("throw",e,a,c)})):t.resolve(l).then((function(e){u.value=e,a(u)}),(function(e){return r("throw",e,a,c)}))}c(s.arg)}var i;o(this,"_invoke",{value:function(e,n){function o(){return new t((function(t,o){r(e,n,t,o)}))}return i=i?i.then(o,o):o()}})}function L(t,r,n){var o=h;return function(i,a){if(o===d)throw Error("Generator is already running");if(o===y){if("throw"===i)throw a;return{value:e,done:!0}}for(n.method=i,n.arg=a;;){var c=n.delegate;if(c){var s=x(c,n);if(s){if(s===m)continue;return s}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(o===h)throw o=y,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o=d;var u=f(t,r,n);if("normal"===u.type){if(o=n.done?y:p,u.arg===m)continue;return{value:u.arg,done:n.done}}"throw"===u.type&&(o=y,n.method="throw",n.arg=u.arg)}}}function x(t,r){var n=r.method,o=t.iterator[n];if(o===e)return r.delegate=null,"throw"===n&&t.iterator.return&&(r.method="return",r.arg=e,x(t,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),m;var i=f(o,t.iterator,r.arg);if("throw"===i.type)return r.method="throw",r.arg=i.arg,r.delegate=null,m;var a=i.arg;return a?a.done?(r[t.resultName]=a.value,r.next=t.nextLoc,"return"!==r.method&&(r.method="next",r.arg=e),r.delegate=null,m):a:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,m)}function P(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function T(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function A(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(P,this),this.reset(!0)}function N(t){if(t||""===t){var r=t[a];if(r)return r.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var o=-1,i=function r(){for(;++o<t.length;)if(n.call(t,o))return r.value=t[o],r.done=!1,r;return r.value=e,r.done=!0,r};return i.next=i}}throw new TypeError(W(t)+" is not iterable")}return g.prototype=b,o(O,"constructor",{value:b,configurable:!0}),o(b,"constructor",{value:g,configurable:!0}),g.displayName=u(b,s,"GeneratorFunction"),t.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===g||"GeneratorFunction"===(t.displayName||t.name))},t.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,b):(e.__proto__=b,u(e,s,"GeneratorFunction")),e.prototype=Object.create(O),e},t.awrap=function(e){return{__await:e}},j(_.prototype),u(_.prototype,c,(function(){return this})),t.AsyncIterator=_,t.async=function(e,r,n,o,i){void 0===i&&(i=Promise);var a=new _(l(e,r,n,o),i);return t.isGeneratorFunction(r)?a:a.next().then((function(e){return e.done?e.value:a.next()}))},j(O),u(O,s,"Generator"),u(O,a,(function(){return this})),u(O,"toString",(function(){return"[object Generator]"})),t.keys=function(e){var t=Object(e),r=[];for(var n in t)r.push(n);return r.reverse(),function e(){for(;r.length;){var n=r.pop();if(n in t)return e.value=n,e.done=!1,e}return e.done=!0,e}},t.values=N,A.prototype={constructor:A,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=e,this.done=!1,this.delegate=null,this.method="next",this.arg=e,this.tryEntries.forEach(T),!t)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=e)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var r=this;function o(n,o){return c.type="throw",c.arg=t,r.next=n,o&&(r.method="next",r.arg=e),!!o}for(var i=this.tryEntries.length-1;i>=0;--i){var a=this.tryEntries[i],c=a.completion;if("root"===a.tryLoc)return o("end");if(a.tryLoc<=this.prev){var s=n.call(a,"catchLoc"),u=n.call(a,"finallyLoc");if(s&&u){if(this.prev<a.catchLoc)return o(a.catchLoc,!0);if(this.prev<a.finallyLoc)return o(a.finallyLoc)}else if(s){if(this.prev<a.catchLoc)return o(a.catchLoc,!0)}else{if(!u)throw Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return o(a.finallyLoc)}}}},abrupt:function(e,t){for(var r=this.tryEntries.length-1;r>=0;--r){var o=this.tryEntries[r];if(o.tryLoc<=this.prev&&n.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var i=o;break}}i&&("break"===e||"continue"===e)&&i.tryLoc<=t&&t<=i.finallyLoc&&(i=null);var a=i?i.completion:{};return a.type=e,a.arg=t,i?(this.method="next",this.next=i.finallyLoc,m):this.complete(a)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),m},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.finallyLoc===e)return this.complete(r.completion,r.afterLoc),T(r),m}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.tryLoc===e){var n=r.completion;if("throw"===n.type){var o=n.arg;T(r)}return o}}throw Error("illegal catch attempt")},delegateYield:function(t,r,n){return this.delegate={iterator:N(t),resultName:r,nextLoc:n},"next"===this.method&&(this.arg=e),m}},t}function Q(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function J(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?Q(Object(r),!0).forEach((function(t){z(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Q(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function z(e,t,r){return(t=function(e){var t=function(e){if("object"!=W(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var r=t.call(e,"string");if("object"!=W(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==W(t)?t:t+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Z(e,t,r,n,o,i,a){try{var c=e[i](a),s=c.value}catch(e){return void r(e)}c.done?t(s):Promise.resolve(s).then(n,o)}function ee(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=Array(t);r<t;r++)n[r]=e[r];return n}window.sendMessage=$,window.getMessagesList=X,window.observeWithXHR=function(e){var t=new XMLHttpRequest,r=0;t.addEventListener("progress",(function(){var n=t.response.substr(r);r=t.response.length;var o=n.match(/event: (.+)/)[1],i=JSON.parse(n.match(/data: (.+)/)[1]);"put"===o&&e(i.data)})),t.open("POST","".concat(B.firebaseBaseUrl,"/").concat(B.firebaseCollection),!0),t.setRequestHeader("Accept","text/event-stream"),t.send()},window.observeWithEventSource=function(e){new EventSource("".concat(B.firebaseBaseUrl,"/").concat(B.firebaseCollection)).addEventListener("put",(function(t){return e(JSON.parse(t.data).data)}))},function(){var e,t=document.querySelector(".left"),r="<tr><th>Вид</th></tr>",n=function(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=function(e,t){if(e){if("string"==typeof e)return ee(e,t);var r={}.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?ee(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0,o=function(){};return{s:o,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,a=!0,c=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return a=e.done,e},e:function(e){c=!0,i=e},f:function(){try{a||null==r.return||r.return()}finally{if(c)throw i}}}}(g);try{for(n.s();!(e=n.n()).done;){var o=e.value;r+='<tr><td class="tsmile" my_data_smile='.concat(o.html,">").concat(o.html,"</td></tr>")}}catch(e){n.e(e)}finally{n.f()}t.innerHTML='<table class="tsmile">'.concat(r,"</table>")}();var te=document.querySelector("#app");te.innerHTML='\n    <div class="message"><input class="text_name" value="name"></input></p>\n    <p><input class="text_input" value="message text"></input></p>\n    \n    <p><button class="send">Send message</button></p>\n    \n    <p class="attention"></p>\n    <p class="theme"></p>\n    <h1 style="color: red" class="error"></h1>\n    <ul class="messages"></ul>';var re=document.querySelector("#users"),ne=function(t){const r=function(e){const{thunk:t=!0,immutableCheck:r=!0,serializableCheck:n=!0,actionCreatorCheck:o=!0}=e??{};let i=new I;return t&&("boolean"==typeof t?i.push(T):i.push(A(t.extraArgument))),i},{reducer:n,middleware:s,devTools:u=!0,preloadedState:l,enhancers:f}=t||{};let h,p;if("function"==typeof n)h=n;else{if(!o(n))throw new Error(`Minified Redux Toolkit error #${d=1}; visit https://redux-toolkit.js.org/Errors?code=${d} for the full message or use the non-minified dev environment for full errors. `);h=a(n)}var d;p="function"==typeof s?s(r):r();let y=c;u&&(y=N({trace:!1,..."object"==typeof u&&u}));const m=function(...t){return r=>(n,o)=>{const i=r(n,o);let a=()=>{throw new Error(e(15))};const s={getState:i.getState,dispatch:(e,...t)=>a(e,...t)},u=t.map((e=>e(s)));return a=c(...u)(i.dispatch),{...i,dispatch:a}}}(...p),v=(e=>function(t){const{autoBatch:r=!0}=t??{};let n=new I(e);return r&&n.push(((e={type:"raf"})=>t=>(...r)=>{const n=t(...r);let o=!0,i=!1,a=!1;const c=new Set,s="tick"===e.type?queueMicrotask:"raf"===e.type?k:"callback"===e.type?e.queueNotification:D(e.timeout),u=()=>{a=!1,i&&(i=!1,c.forEach((e=>e())))};return Object.assign({},n,{subscribe(e){const t=n.subscribe((()=>o&&e()));return c.add(e),()=>{t(),c.delete(e)}},dispatch(e){try{return o=!e?.meta?.RTK_autoBatch,i=!o,i&&(a||(a=!0,s(u))),n.dispatch(e)}finally{o=!0}}})})("object"==typeof r?r:void 0)),n})(m);return i(h,l,y(..."function"==typeof f?f(v):v()))}({reducer:x,middleware:function(e){return e({serializableCheck:!1})}});function oe(e){return function(t,r){t({type:d,message:e}),console.log("type messate"),$(e).then((function(){console.log("before send"),t({type:p,message:e}),console.log("after send")}))}}function ie(){return console.log("browseAllMessagesIfNeeded"),function(e,t){if(function(e){var t,r=e(),n=Date.now()+r.message.delay,o=(r.message.selectedTheme,r.message.messages.didInvalidate);return n>(null!==(t=r.message.messages.lastUpdated)&&void 0!==t?t:0)||o}(t))return console.log("need update"),e((function(e,t){e({type:u,theme:""}),console.log("request messate"),X().then((function(r){var n=t();console.log("before");var o=new Date(2024,0,0),i=r.filter((function(e){return!!e.date&&e.date>o})).sort((function(e,t){return t.date.valueOf()>e.date.valueOf()?1:-1}));if(new Array,console.log("state.message.messages.items.length ",n.message.messages.items.length),n.message.messages.items.length>0){var a=n.message.messages.items[0],c=i.findIndex((function(e){return e.message===a.message&&e.name===a.name&&e.now===a.now})),s=i.filter((function(e,t){return t<c}));console.log("m1, m1"),e(y("",i,s))}else console.log("m, m"),e(y("",i,i));var u=new Array;i.forEach((function(e){e.name&&u.push(e.name.trim())}));var l,h=new Set(u);e((l=Array.from(h).sort((function(e,t){return e>t?1:e<t?-1:0})),{type:f,items:l,receivedAt:Date.now()})),console.log("after")}))}))}}function ae(e){console.log("in applySmileInput ");var t,r=e.target,n="";r.hasAttribute("my_data_smile")&&(n=null!==(t=r.getAttribute("my_data_smile"))&&void 0!==t?t:""),console.log(r),console.log(n);var o=document.querySelector(".text_input"),i=document.querySelector(".text_name"),a={message:o.value+n,name:i.value,now:Date.now()};console.log(o),ne.dispatch(m(a))}function ce(){var e=document.querySelector(".text_input"),t=document.querySelector(".text_name"),r={message:e.value,name:t.value,now:Date.now()};console.log("typing"),ne.dispatch(m(r))}function se(){return ue.apply(this,arguments)}function ue(){return(e=K().mark((function e(){var t,r,n;return K().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:console.log("send"),t=document.querySelector(".text_input"),r=document.querySelector(".text_name"),n={message:t.value,name:r.value,now:Date.now()},ne.dispatch(oe(n));case 5:case"end":return e.stop()}}),e)})),ue=function(){var t=this,r=arguments;return new Promise((function(n,o){var i=e.apply(t,r);function a(e){Z(i,n,o,a,c,"next",e)}function c(e){Z(i,n,o,a,c,"throw",e)}a(void 0)}))}).apply(this,arguments);var e}var le=function(e){var t,r,n;if(console.log("render",e),e.isLoading){var o=te.querySelector(".attention");o&&(o.innerHTML="Messages is loading")}else{var i=te.querySelector(".attention");i&&(i.innerHTML="")}if(e.theme){var a=te.querySelector(".theme");a&&(a.innerHTML="Selected is ".concat(e.theme," "))}if(e.error){var c=te.querySelector(".error");c&&(c.innerHTML="".concat(e.error))}if(e.data.length>0){var s=te.querySelector(".messages");s&&(s.innerHTML="");for(var u=0;u<e.data.length;u++){var l,f=J({},e.data[u]),h=document.createElement("li");h.innerHTML='<p class="username">'.concat(f.name,'</p>\n                        <p class="text">').concat(f.message,'</p>\n                        <p class="time">').concat(null===(l=f.date)||void 0===l?void 0:l.toDateString(),"</p>"),s&&s.insertAdjacentElement("beforeend",h)}}if(e.text)if(e.text.isTyping)console.log("is typing"),document.querySelector(".text_input").value=e.text.message.message,te.querySelector(".send").disabled=!1;else if(e.text.isTyping||e.text.isSend){console.log("end send");var p=document.querySelector(".text_input");p.value="",(p=document.querySelector(".text_name")).value="",te.querySelector(".send").disabled=!1}else console.log("end typing"),te.querySelector(".send").disabled=!0;else te.querySelector(".send").disabled=!1;null===(t=te.querySelector(".text_input"))||void 0===t||t.addEventListener("input",ce),null===(r=te.querySelector(".send"))||void 0===r||r.addEventListener("click",se),null===(n=document.querySelector(".tsmile"))||void 0===n||n.addEventListener("click",ae)},fe=function(e){return{isLoading:e.users.users.isFetching,data:e.users.users.items,error:e.users.users.error}},he=function(e){if(console.log("users",e),e.isLoading)return re.innerHTML="users is loading";if(e.data){re.innerHTML='<ul class="usersL"></ul>';for(var t=re.querySelector(".usersL"),r=0;r<e.data.length;r++){var n=document.createElement("li");n.innerHTML='<p class="username">'.concat(e.data[r],"</p>"),t&&t.appendChild(n)}return re}return e.error?re.innerHTML="<pre>".concat(e.error,"</pre>"):void 0},pe=function(e){return{isLoading:e.message.messages.isFetching,data:e.message.messages.items.slice(0,20),error:e.message.messages.error,theme:e.message.selectedTheme,isSended:e.message.isSend,text:e.message.messageSend}};le(pe(ne.getState())),he(fe(ne.getState())),ne.subscribe((function(){return le(pe(ne.getState()))})),ne.subscribe((function(){return he(fe(ne.getState()))})),setInterval((function(){return ne.dispatch(ie())}),3e3)})();
//# sourceMappingURL=main.bundle.js.map