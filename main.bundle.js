/*! For license information please see main.bundle.js.LICENSE.txt */
(()=>{"use strict";function e(e){return`Minified Redux error #${e}; visit https://redux.js.org/Errors?code=${e} for the full message or use the non-minified dev environment for full errors. `}var t=(()=>"function"==typeof Symbol&&Symbol.observable||"@@observable")(),r=()=>Math.random().toString(36).substring(7).split("").join("."),n={INIT:`@@redux/INIT${r()}`,REPLACE:`@@redux/REPLACE${r()}`,PROBE_UNKNOWN_ACTION:()=>`@@redux/PROBE_UNKNOWN_ACTION${r()}`};function o(e){if("object"!=typeof e||null===e)return!1;let t=e;for(;null!==Object.getPrototypeOf(t);)t=Object.getPrototypeOf(t);return Object.getPrototypeOf(e)===t||null===Object.getPrototypeOf(e)}function i(r,a,c){if("function"!=typeof r)throw new Error(e(2));if("function"==typeof a&&"function"==typeof c||"function"==typeof c&&"function"==typeof arguments[3])throw new Error(e(0));if("function"==typeof a&&void 0===c&&(c=a,a=void 0),void 0!==c){if("function"!=typeof c)throw new Error(e(1));return c(i)(r,a)}let s=r,u=a,l=new Map,f=l,h=0,p=!1;function d(){f===l&&(f=new Map,l.forEach(((e,t)=>{f.set(t,e)})))}function y(){if(p)throw new Error(e(3));return u}function v(t){if("function"!=typeof t)throw new Error(e(4));if(p)throw new Error(e(5));let r=!0;d();const n=h++;return f.set(n,t),function(){if(r){if(p)throw new Error(e(6));r=!1,d(),f.delete(n),l=null}}}function m(t){if(!o(t))throw new Error(e(7));if(void 0===t.type)throw new Error(e(8));if("string"!=typeof t.type)throw new Error(e(17));if(p)throw new Error(e(9));try{p=!0,u=s(u,t)}finally{p=!1}return(l=f).forEach((e=>{e()})),t}return m({type:n.INIT}),{dispatch:m,subscribe:v,getState:y,replaceReducer:function(t){if("function"!=typeof t)throw new Error(e(10));s=t,m({type:n.REPLACE})},[t]:function(){const r=v;return{subscribe(t){if("object"!=typeof t||null===t)throw new Error(e(11));function n(){const e=t;e.next&&e.next(y())}return n(),{unsubscribe:r(n)}},[t](){return this}}}}}function a(t){const r=Object.keys(t),o={};for(let e=0;e<r.length;e++){const n=r[e];"function"==typeof t[n]&&(o[n]=t[n])}const i=Object.keys(o);let a;try{!function(t){Object.keys(t).forEach((r=>{const o=t[r];if(void 0===o(void 0,{type:n.INIT}))throw new Error(e(12));if(void 0===o(void 0,{type:n.PROBE_UNKNOWN_ACTION()}))throw new Error(e(13))}))}(o)}catch(e){a=e}return function(t={},r){if(a)throw a;let n=!1;const c={};for(let a=0;a<i.length;a++){const s=i[a],u=o[s],l=t[s],f=u(l,r);if(void 0===f)throw r&&r.type,new Error(e(14));c[s]=f,n=n||f!==l}return n=n||i.length!==Object.keys(t).length,n?c:t}}function c(...e){return 0===e.length?e=>e:1===e.length?e[0]:e.reduce(((e,t)=>(...r)=>e(t(...r))))}var s={message:"",now:Date.now(),name:""},u="REQUEST_MESSAGES",l="RECEIVE_MESSAGES",f="RECEIVE_USERS",h="BEGIN_TYPE_MESSAGE",p="END_SEND_MESSAGE",d="END_TYPE_MESSAGE";function y(e){return{type:h,message:e}}function v(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=Array(t);r<t;r++)n[r]=e[r];return n}var m=[{symb:":-)",html:"&#128512;"},{symb:"=)",html:"&#128512;"},{symb:":-D",html:"&#128515;"},{symb:":-(",html:"&#128545;"},{symb:"*O*",html:"&#128525;"},{symb:"XD",html:"&#128518;"},{symb:":-|",html:"&#129300;"},{symb:":-/",html:"&#128533;"},{symb:":O",html:"&#128565;"}];function g(e){return g="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},g(e)}function b(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function w(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?b(Object(r),!0).forEach((function(t){E(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):b(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function E(e,t,r){return(t=function(e){var t=function(e){if("object"!=g(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var r=t.call(e,"string");if("object"!=g(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==g(t)?t:t+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var S={delay:3,messages:{isFetching:!1,didInvalidate:!1,items:[]},isSend:!0},O={delay:3,users:{isFetching:!1,didInvalidate:!1,items:[]}},j={isFetching:!1,didInvalidate:!1,items:[]},_={isFetching:!1,didInvalidate:!1,items:[]},L=a({message:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:S,t=arguments.length>1?arguments[1]:void 0;switch(w({},e),t.type){case"SET_STORAGE":return w(w({},e),{},{messageStorage:t.storage});case"REQUEST_MESSAGE":var r,n=null!==(r=t.id)&&void 0!==r?r:0,o=Object.assign({},j);return o.isFetching=!0,o.didInvalidate=!1,w(w({},e),{},{messages:o,selectedID:n});case h:var i,a={isSend:!1,message:null!==(i=t.message)&&void 0!==i?i:s,error:"",isTyping:!0};return w(w({},e),{},{messageSend:a,isSend:!1});case d:var c,u={isSend:!1,message:null!==(c=t.message)&&void 0!==c?c:s,error:"",isTyping:!1};return w(w({},e),{},{messageSend:u,isSend:!1});case p:var l,f={isSend:!0,message:null!==(l=t.message)&&void 0!==l?l:s,error:"",isTyping:!1};return w(w({},e),{},{messageSend:f,isSend:!0});case"REQUEST_MESSAGES":var y,g=null!==(y=t.theme)&&void 0!==y?y:"",b=Object.assign({},e.messages);return b.isFetching=!0,b.didInvalidate=!1,w(w({},e),{},{messages:b,selectTheme:g});case"RECEIVE_MESSAGES":case"RECEIVE_ERROR":var E,O,_,L,x=null!==(E=t.theme)&&void 0!==E?E:"",P=null!==(O=t.receivedAt)&&void 0!==O?O:Date.now(),T=null!==(_=t.messages)&&void 0!==_?_:[],A=null!==(L=t.error)&&void 0!==L?L:"",N=t.id,I=Object.assign({},e.messages,{lastUpdated:P,items:T,error:A});return I.isFetching=!1,w(w({},e),{},{messages:I,selectTheme:x,selectedID:N});case"APPLY_SMILE":var k,D=null!==(k=t.message)&&void 0!==k?k:s;D.message=function(e){var t,r=e,n=function(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=function(e,t){if(e){if("string"==typeof e)return v(e,t);var r={}.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?v(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0,o=function(){};return{s:o,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,a=!0,c=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return a=e.done,e},e:function(e){c=!0,i=e},f:function(){try{a||null==r.return||r.return()}finally{if(c)throw i}}}}(m);try{for(n.s();!(t=n.n()).done;){var o=t.value;r=r.replace(o.symb,o.html)}}catch(e){n.e(e)}finally{n.f()}return r}(null==D?void 0:D.message);var R={isSend:!0,message:D,error:""};return w(w({},e),{},{messageSend:R});default:return e}},users:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:O,t=arguments.length>1?arguments[1]:void 0;switch(w({},e),t.type){case"REQUEST_USERS":t.theme;var r=Object.assign({},_);return r.isFetching=!0,w(w({},e),{},{users:r});case"RECEIVE_USERS":case"RECEIVE_ERROR_USER":var n,o,i,a=null!==(n=t.receivedAt)&&void 0!==n?n:Date.now(),c=null!==(o=t.items)&&void 0!==o?o:[],s=null!==(i=t.error)&&void 0!==i?i:"",u=Object.assign({},_,{lastUpdated:a,items:c,error:s,isFetching:!1});return w(w({},e),{},{users:u});default:return e}}});function x(e){return({dispatch:t,getState:r})=>n=>o=>"function"==typeof o?o(t,r,e):n(o)}var P=x(),T=x,A="undefined"!=typeof window&&window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__?window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__:function(){if(0!==arguments.length)return"object"==typeof arguments[0]?c:c.apply(null,arguments)};"undefined"!=typeof window&&window.__REDUX_DEVTOOLS_EXTENSION__&&window.__REDUX_DEVTOOLS_EXTENSION__;var N=class e extends Array{constructor(...t){super(...t),Object.setPrototypeOf(this,e.prototype)}static get[Symbol.species](){return e}concat(...e){return super.concat.apply(this,e)}prepend(...t){return 1===t.length&&Array.isArray(t[0])?new e(...t[0].concat(this)):new e(...t.concat(this))}},I=e=>t=>{setTimeout(t,e)},k="undefined"!=typeof window&&window.requestAnimationFrame?window.requestAnimationFrame:I(10),{assign:D}=Object;function R(e){return R="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},R(e)}function M(){M=function(){return t};var e,t={},r=Object.prototype,n=r.hasOwnProperty,o=Object.defineProperty||function(e,t,r){e[t]=r.value},i="function"==typeof Symbol?Symbol:{},a=i.iterator||"@@iterator",c=i.asyncIterator||"@@asyncIterator",s=i.toStringTag||"@@toStringTag";function u(e,t,r){return Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{u({},"")}catch(e){u=function(e,t,r){return e[t]=r}}function l(e,t,r,n){var i=t&&t.prototype instanceof m?t:m,a=Object.create(i.prototype),c=new A(n||[]);return o(a,"_invoke",{value:L(e,r,c)}),a}function f(e,t,r){try{return{type:"normal",arg:e.call(t,r)}}catch(e){return{type:"throw",arg:e}}}t.wrap=l;var h="suspendedStart",p="suspendedYield",d="executing",y="completed",v={};function m(){}function g(){}function b(){}var w={};u(w,a,(function(){return this}));var E=Object.getPrototypeOf,S=E&&E(E(N([])));S&&S!==r&&n.call(S,a)&&(w=S);var O=b.prototype=m.prototype=Object.create(w);function j(e){["next","throw","return"].forEach((function(t){u(e,t,(function(e){return this._invoke(t,e)}))}))}function _(e,t){function r(o,i,a,c){var s=f(e[o],e,i);if("throw"!==s.type){var u=s.arg,l=u.value;return l&&"object"==R(l)&&n.call(l,"__await")?t.resolve(l.__await).then((function(e){r("next",e,a,c)}),(function(e){r("throw",e,a,c)})):t.resolve(l).then((function(e){u.value=e,a(u)}),(function(e){return r("throw",e,a,c)}))}c(s.arg)}var i;o(this,"_invoke",{value:function(e,n){function o(){return new t((function(t,o){r(e,n,t,o)}))}return i=i?i.then(o,o):o()}})}function L(t,r,n){var o=h;return function(i,a){if(o===d)throw Error("Generator is already running");if(o===y){if("throw"===i)throw a;return{value:e,done:!0}}for(n.method=i,n.arg=a;;){var c=n.delegate;if(c){var s=x(c,n);if(s){if(s===v)continue;return s}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(o===h)throw o=y,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o=d;var u=f(t,r,n);if("normal"===u.type){if(o=n.done?y:p,u.arg===v)continue;return{value:u.arg,done:n.done}}"throw"===u.type&&(o=y,n.method="throw",n.arg=u.arg)}}}function x(t,r){var n=r.method,o=t.iterator[n];if(o===e)return r.delegate=null,"throw"===n&&t.iterator.return&&(r.method="return",r.arg=e,x(t,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),v;var i=f(o,t.iterator,r.arg);if("throw"===i.type)return r.method="throw",r.arg=i.arg,r.delegate=null,v;var a=i.arg;return a?a.done?(r[t.resultName]=a.value,r.next=t.nextLoc,"return"!==r.method&&(r.method="next",r.arg=e),r.delegate=null,v):a:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,v)}function P(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function T(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function A(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(P,this),this.reset(!0)}function N(t){if(t||""===t){var r=t[a];if(r)return r.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var o=-1,i=function r(){for(;++o<t.length;)if(n.call(t,o))return r.value=t[o],r.done=!1,r;return r.value=e,r.done=!0,r};return i.next=i}}throw new TypeError(R(t)+" is not iterable")}return g.prototype=b,o(O,"constructor",{value:b,configurable:!0}),o(b,"constructor",{value:g,configurable:!0}),g.displayName=u(b,s,"GeneratorFunction"),t.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===g||"GeneratorFunction"===(t.displayName||t.name))},t.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,b):(e.__proto__=b,u(e,s,"GeneratorFunction")),e.prototype=Object.create(O),e},t.awrap=function(e){return{__await:e}},j(_.prototype),u(_.prototype,c,(function(){return this})),t.AsyncIterator=_,t.async=function(e,r,n,o,i){void 0===i&&(i=Promise);var a=new _(l(e,r,n,o),i);return t.isGeneratorFunction(r)?a:a.next().then((function(e){return e.done?e.value:a.next()}))},j(O),u(O,s,"Generator"),u(O,a,(function(){return this})),u(O,"toString",(function(){return"[object Generator]"})),t.keys=function(e){var t=Object(e),r=[];for(var n in t)r.push(n);return r.reverse(),function e(){for(;r.length;){var n=r.pop();if(n in t)return e.value=n,e.done=!1,e}return e.done=!0,e}},t.values=N,A.prototype={constructor:A,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=e,this.done=!1,this.delegate=null,this.method="next",this.arg=e,this.tryEntries.forEach(T),!t)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=e)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var r=this;function o(n,o){return c.type="throw",c.arg=t,r.next=n,o&&(r.method="next",r.arg=e),!!o}for(var i=this.tryEntries.length-1;i>=0;--i){var a=this.tryEntries[i],c=a.completion;if("root"===a.tryLoc)return o("end");if(a.tryLoc<=this.prev){var s=n.call(a,"catchLoc"),u=n.call(a,"finallyLoc");if(s&&u){if(this.prev<a.catchLoc)return o(a.catchLoc,!0);if(this.prev<a.finallyLoc)return o(a.finallyLoc)}else if(s){if(this.prev<a.catchLoc)return o(a.catchLoc,!0)}else{if(!u)throw Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return o(a.finallyLoc)}}}},abrupt:function(e,t){for(var r=this.tryEntries.length-1;r>=0;--r){var o=this.tryEntries[r];if(o.tryLoc<=this.prev&&n.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var i=o;break}}i&&("break"===e||"continue"===e)&&i.tryLoc<=t&&t<=i.finallyLoc&&(i=null);var a=i?i.completion:{};return a.type=e,a.arg=t,i?(this.method="next",this.next=i.finallyLoc,v):this.complete(a)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),v},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.finallyLoc===e)return this.complete(r.completion,r.afterLoc),T(r),v}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.tryLoc===e){var n=r.completion;if("throw"===n.type){var o=n.arg;T(r)}return o}}throw Error("illegal catch attempt")},delegateYield:function(t,r,n){return this.delegate={iterator:N(t),resultName:r,nextLoc:n},"next"===this.method&&(this.arg=e),v}},t}function q(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function C(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?q(Object(r),!0).forEach((function(t){G(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):q(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function G(e,t,r){return(t=function(e){var t=function(e){if("object"!=R(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var r=t.call(e,"string");if("object"!=R(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==R(t)?t:t+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function U(e,t,r,n,o,i,a){try{var c=e[i](a),s=c.value}catch(e){return void r(e)}c.done?t(s):Promise.resolve(s).then(n,o)}function F(e){return function(){var t=this,r=arguments;return new Promise((function(n,o){var i=e.apply(t,r);function a(e){U(i,n,o,a,c,"next",e)}function c(e){U(i,n,o,a,c,"throw",e)}a(void 0)}))}}Symbol.for("rtk-state-proxy-original");var H={firebaseBaseUrl:"https://otus-js-chat-4ed79-default-rtdb.firebaseio.com",firebaseCollection:"messages.json"};function B(){return X.apply(this,arguments)}function X(){return(X=F(M().mark((function e(){return M().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",fetch("".concat(H.firebaseBaseUrl,"/").concat(H.firebaseCollection),{headers:{Accept:"application/json","Content-Type":"application/json"}}).then((function(e){return e.json()})).then((function(e){return Object.values(e).map((function(e){return C(C({},e),{},{date:new Date(e.date)})}))})));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function V(e){return $.apply(this,arguments)}function $(){return($=F(M().mark((function e(t){return M().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",fetch("".concat(H.firebaseBaseUrl,"/").concat(H.firebaseCollection),{method:"POST",body:JSON.stringify(C(C({},t),{},{date:new Date})),headers:{Accept:"application/json","Content-Type":"application/json"}}).then((function(e){return e.json()})));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Y(e){return Y="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Y(e)}function W(){W=function(){return t};var e,t={},r=Object.prototype,n=r.hasOwnProperty,o=Object.defineProperty||function(e,t,r){e[t]=r.value},i="function"==typeof Symbol?Symbol:{},a=i.iterator||"@@iterator",c=i.asyncIterator||"@@asyncIterator",s=i.toStringTag||"@@toStringTag";function u(e,t,r){return Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{u({},"")}catch(e){u=function(e,t,r){return e[t]=r}}function l(e,t,r,n){var i=t&&t.prototype instanceof m?t:m,a=Object.create(i.prototype),c=new A(n||[]);return o(a,"_invoke",{value:L(e,r,c)}),a}function f(e,t,r){try{return{type:"normal",arg:e.call(t,r)}}catch(e){return{type:"throw",arg:e}}}t.wrap=l;var h="suspendedStart",p="suspendedYield",d="executing",y="completed",v={};function m(){}function g(){}function b(){}var w={};u(w,a,(function(){return this}));var E=Object.getPrototypeOf,S=E&&E(E(N([])));S&&S!==r&&n.call(S,a)&&(w=S);var O=b.prototype=m.prototype=Object.create(w);function j(e){["next","throw","return"].forEach((function(t){u(e,t,(function(e){return this._invoke(t,e)}))}))}function _(e,t){function r(o,i,a,c){var s=f(e[o],e,i);if("throw"!==s.type){var u=s.arg,l=u.value;return l&&"object"==Y(l)&&n.call(l,"__await")?t.resolve(l.__await).then((function(e){r("next",e,a,c)}),(function(e){r("throw",e,a,c)})):t.resolve(l).then((function(e){u.value=e,a(u)}),(function(e){return r("throw",e,a,c)}))}c(s.arg)}var i;o(this,"_invoke",{value:function(e,n){function o(){return new t((function(t,o){r(e,n,t,o)}))}return i=i?i.then(o,o):o()}})}function L(t,r,n){var o=h;return function(i,a){if(o===d)throw Error("Generator is already running");if(o===y){if("throw"===i)throw a;return{value:e,done:!0}}for(n.method=i,n.arg=a;;){var c=n.delegate;if(c){var s=x(c,n);if(s){if(s===v)continue;return s}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(o===h)throw o=y,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o=d;var u=f(t,r,n);if("normal"===u.type){if(o=n.done?y:p,u.arg===v)continue;return{value:u.arg,done:n.done}}"throw"===u.type&&(o=y,n.method="throw",n.arg=u.arg)}}}function x(t,r){var n=r.method,o=t.iterator[n];if(o===e)return r.delegate=null,"throw"===n&&t.iterator.return&&(r.method="return",r.arg=e,x(t,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),v;var i=f(o,t.iterator,r.arg);if("throw"===i.type)return r.method="throw",r.arg=i.arg,r.delegate=null,v;var a=i.arg;return a?a.done?(r[t.resultName]=a.value,r.next=t.nextLoc,"return"!==r.method&&(r.method="next",r.arg=e),r.delegate=null,v):a:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,v)}function P(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function T(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function A(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(P,this),this.reset(!0)}function N(t){if(t||""===t){var r=t[a];if(r)return r.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var o=-1,i=function r(){for(;++o<t.length;)if(n.call(t,o))return r.value=t[o],r.done=!1,r;return r.value=e,r.done=!0,r};return i.next=i}}throw new TypeError(Y(t)+" is not iterable")}return g.prototype=b,o(O,"constructor",{value:b,configurable:!0}),o(b,"constructor",{value:g,configurable:!0}),g.displayName=u(b,s,"GeneratorFunction"),t.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===g||"GeneratorFunction"===(t.displayName||t.name))},t.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,b):(e.__proto__=b,u(e,s,"GeneratorFunction")),e.prototype=Object.create(O),e},t.awrap=function(e){return{__await:e}},j(_.prototype),u(_.prototype,c,(function(){return this})),t.AsyncIterator=_,t.async=function(e,r,n,o,i){void 0===i&&(i=Promise);var a=new _(l(e,r,n,o),i);return t.isGeneratorFunction(r)?a:a.next().then((function(e){return e.done?e.value:a.next()}))},j(O),u(O,s,"Generator"),u(O,a,(function(){return this})),u(O,"toString",(function(){return"[object Generator]"})),t.keys=function(e){var t=Object(e),r=[];for(var n in t)r.push(n);return r.reverse(),function e(){for(;r.length;){var n=r.pop();if(n in t)return e.value=n,e.done=!1,e}return e.done=!0,e}},t.values=N,A.prototype={constructor:A,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=e,this.done=!1,this.delegate=null,this.method="next",this.arg=e,this.tryEntries.forEach(T),!t)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=e)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var r=this;function o(n,o){return c.type="throw",c.arg=t,r.next=n,o&&(r.method="next",r.arg=e),!!o}for(var i=this.tryEntries.length-1;i>=0;--i){var a=this.tryEntries[i],c=a.completion;if("root"===a.tryLoc)return o("end");if(a.tryLoc<=this.prev){var s=n.call(a,"catchLoc"),u=n.call(a,"finallyLoc");if(s&&u){if(this.prev<a.catchLoc)return o(a.catchLoc,!0);if(this.prev<a.finallyLoc)return o(a.finallyLoc)}else if(s){if(this.prev<a.catchLoc)return o(a.catchLoc,!0)}else{if(!u)throw Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return o(a.finallyLoc)}}}},abrupt:function(e,t){for(var r=this.tryEntries.length-1;r>=0;--r){var o=this.tryEntries[r];if(o.tryLoc<=this.prev&&n.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var i=o;break}}i&&("break"===e||"continue"===e)&&i.tryLoc<=t&&t<=i.finallyLoc&&(i=null);var a=i?i.completion:{};return a.type=e,a.arg=t,i?(this.method="next",this.next=i.finallyLoc,v):this.complete(a)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),v},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.finallyLoc===e)return this.complete(r.completion,r.afterLoc),T(r),v}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.tryLoc===e){var n=r.completion;if("throw"===n.type){var o=n.arg;T(r)}return o}}throw Error("illegal catch attempt")},delegateYield:function(t,r,n){return this.delegate={iterator:N(t),resultName:r,nextLoc:n},"next"===this.method&&(this.arg=e),v}},t}function K(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function Q(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?K(Object(r),!0).forEach((function(t){J(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):K(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function J(e,t,r){return(t=function(e){var t=function(e){if("object"!=Y(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var r=t.call(e,"string");if("object"!=Y(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==Y(t)?t:t+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function z(e,t,r,n,o,i,a){try{var c=e[i](a),s=c.value}catch(e){return void r(e)}c.done?t(s):Promise.resolve(s).then(n,o)}function Z(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=Array(t);r<t;r++)n[r]=e[r];return n}window.sendMessage=V,window.getMessagesList=B,window.observeWithXHR=function(e){var t=new XMLHttpRequest,r=0;t.addEventListener("progress",(function(){var n=t.response.substr(r);r=t.response.length;var o=n.match(/event: (.+)/)[1],i=JSON.parse(n.match(/data: (.+)/)[1]);"put"===o&&e(i.data)})),t.open("POST","".concat(H.firebaseBaseUrl,"/").concat(H.firebaseCollection),!0),t.setRequestHeader("Accept","text/event-stream"),t.send()},window.observeWithEventSource=function(e){new EventSource("".concat(H.firebaseBaseUrl,"/").concat(H.firebaseCollection)).addEventListener("put",(function(t){return e(JSON.parse(t.data).data)}))},function(){var e,t=document.querySelector(".left"),r="<tr><th>Вид</th></tr>",n=function(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=function(e,t){if(e){if("string"==typeof e)return Z(e,t);var r={}.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?Z(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0,o=function(){};return{s:o,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,a=!0,c=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return a=e.done,e},e:function(e){c=!0,i=e},f:function(){try{a||null==r.return||r.return()}finally{if(c)throw i}}}}(m);try{for(n.s();!(e=n.n()).done;){var o=e.value;r+='<tr><td class="tsmile" my_data_smile='.concat(o.html,">").concat(o.html,"</td></tr>")}}catch(e){n.e(e)}finally{n.f()}t.innerHTML='<table class="tsmile">'.concat(r,"</table>")}(),document.querySelector("#app").innerHTML='\n        <div class="message"><input class="text_name" value="name"></input></p>\n        <p><input class="text_input" value="message text"></input></p>\n        \n        <p><button class="send">Send message</button></p>\n        \n        <p class="attention"></p>\n        <p class="theme"></p>\n        <h1 style="color: red" class="error"></h1>\n        <ul class="messages"></ul>',document.querySelector("#users");var ee=function(t){const r=function(e){const{thunk:t=!0,immutableCheck:r=!0,serializableCheck:n=!0,actionCreatorCheck:o=!0}=e??{};let i=new N;return t&&("boolean"==typeof t?i.push(P):i.push(T(t.extraArgument))),i},{reducer:n,middleware:s,devTools:u=!0,preloadedState:l,enhancers:f}=t||{};let h,p;if("function"==typeof n)h=n;else{if(!o(n))throw new Error(`Minified Redux Toolkit error #${d=1}; visit https://redux-toolkit.js.org/Errors?code=${d} for the full message or use the non-minified dev environment for full errors. `);h=a(n)}var d;p="function"==typeof s?s(r):r();let y=c;u&&(y=A({trace:!1,..."object"==typeof u&&u}));const v=function(...t){return r=>(n,o)=>{const i=r(n,o);let a=()=>{throw new Error(e(15))};const s={getState:i.getState,dispatch:(e,...t)=>a(e,...t)},u=t.map((e=>e(s)));return a=c(...u)(i.dispatch),{...i,dispatch:a}}}(...p),m=(e=>function(t){const{autoBatch:r=!0}=t??{};let n=new N(e);return r&&n.push(((e={type:"raf"})=>t=>(...r)=>{const n=t(...r);let o=!0,i=!1,a=!1;const c=new Set,s="tick"===e.type?queueMicrotask:"raf"===e.type?k:"callback"===e.type?e.queueNotification:I(e.timeout),u=()=>{a=!1,i&&(i=!1,c.forEach((e=>e())))};return Object.assign({},n,{subscribe(e){const t=n.subscribe((()=>o&&e()));return c.add(e),()=>{t(),c.delete(e)}},dispatch(e){try{return o=!e?.meta?.RTK_autoBatch,i=!o,i&&(a||(a=!0,s(u))),n.dispatch(e)}finally{o=!0}}})})("object"==typeof r?r:void 0)),n})(v);return i(h,l,y(..."function"==typeof f?f(m):m()))}({reducer:L,middleware:function(e){return e({serializableCheck:!1})}});function te(e){return function(t,r){t({type:d,message:e}),console.log("type messate"),V(e).then((function(){console.log("before send"),t({type:p,message:e}),console.log("after send")}))}}function re(){return console.log("browseAllMessagesIfNeeded"),function(e,t){if(function(e){var t,r=e(),n=Date.now()+r.message.delay,o=(r.message.selectedTheme,r.message.messages.didInvalidate);return n>(null!==(t=r.message.messages.lastUpdated)&&void 0!==t?t:0)||o}(t))return console.log("need update"),e((function(e,t){e({type:u,theme:""}),console.log("request messate"),B().then((function(t){console.log("before");var r=t.sort((function(e,t){return t.date.valueOf()>e.date.valueOf()?1:-1}));e({type:l,theme:"",messages:r,receivedAt:Date.now()});var n=new Array;r.forEach((function(e){e.name&&n.push(e.name.trim())}));var o,i=new Set(n);e((o=Array.from(i).sort((function(e,t){return e>t?1:e<t?-1:0})),{type:f,items:o,receivedAt:Date.now()})),console.log("after")}))}))}}function ne(e){console.log("in applySmileInput ");var t,r=e.target,n="";r.hasAttribute("my_data_smile")&&(n=null!==(t=r.getAttribute("my_data_smile"))&&void 0!==t?t:"");var o=ee.getState();if(o.message.messageSend){var i=Q({},o.message.messageSend.message);i.message+=n,ee.dispatch(y(i))}}function oe(){var e=document.querySelector(".text_input"),t=document.querySelector(".text_name"),r={message:e.value,name:t.value,now:Date.now()};console.log("typing"),ee.dispatch(y(r))}function ie(){return ae.apply(this,arguments)}function ae(){return(e=W().mark((function e(){var t,r;return W().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:console.log("send"),(t=ee.getState()).message.messageSend&&((r=Q({},t.message.messageSend.message)).now=Date.now(),ee.dispatch(te(r)));case 3:case"end":return e.stop()}}),e)})),ae=function(){var t=this,r=arguments;return new Promise((function(n,o){var i=e.apply(t,r);function a(e){z(i,n,o,a,c,"next",e)}function c(e){z(i,n,o,a,c,"throw",e)}a(void 0)}))}).apply(this,arguments);var e}var ce=function(e){var t,r,n,o=document.querySelector("#app");if(console.log("render",e),e.isLoading){var i=o.querySelector(".attention");i&&(i.innerHTML="Messages is loading")}else{var a=o.querySelector(".attention");a&&(a.innerHTML="")}if(e.theme){var c=o.querySelector(".theme");c&&(c.innerHTML="Selected is ".concat(e.theme," "))}if(e.error){var s=o.querySelector(".error");s&&(s.innerHTML="".concat(e.error))}if(e.data.length>0){var u=o.querySelector(".messages");u&&(u.innerHTML="");for(var l=0;l<e.data.length;l++){var f,h=Q({},e.data[l]),p=document.createElement("li");p.innerHTML='<p class="username">'.concat(h.name,'</p>\n                        <p class="text">').concat(h.message,'</p>\n                        <p class="time">').concat(null===(f=h.date)||void 0===f?void 0:f.toDateString(),"</p>"),u&&u.insertAdjacentElement("beforeend",p)}}if(e.text)if(e.text.isTyping)console.log("is typing"),document.querySelector(".text_input").value=e.text.message.message,o.querySelector(".send").disabled=!1;else if(e.text.isTyping||e.text.isSend){console.log("end send");var d=document.querySelector(".text_input");d.value="",(d=document.querySelector(".text_name")).value="",o.querySelector(".send").disabled=!1}else console.log("end typing"),o.querySelector(".send").disabled=!0;else o.querySelector(".send").disabled=!1;null===(t=o.querySelector(".text_input"))||void 0===t||t.addEventListener("input",oe),null===(r=o.querySelector(".send"))||void 0===r||r.addEventListener("click",ie),null===(n=document.querySelector(".tsmile"))||void 0===n||n.addEventListener("click",ne)},se=function(e){return{isLoading:e.users.users.isFetching,data:e.users.users.items,error:e.users.users.error}},ue=function(e){var t=document.querySelector("#users");if(console.log("users",e),e.isLoading)return t.innerHTML="users is loading";if(e.data){t.innerHTML='<ul class="usersL"></ul>';for(var r=t.querySelector(".usersL"),n=0;n<e.data.length;n++){var o=document.createElement("li");o.innerHTML='<p class="username">'.concat(e.data[n],"</p>"),r&&r.appendChild(o)}return t}return e.error?t.innerHTML="<pre>".concat(e.error,"</pre>"):void 0},le=function(e){return{isLoading:e.message.messages.isFetching,data:e.message.messages.items.slice(0,20),error:e.message.messages.error,theme:e.message.selectedTheme,isSended:e.message.isSend,text:e.message.messageSend}};ce(le(ee.getState())),ue(se(ee.getState())),ee.subscribe((function(){return ce(le(ee.getState()))})),ee.subscribe((function(){return ue(se(ee.getState()))})),setInterval((function(){return ee.dispatch(re())}),3e3)})();
//# sourceMappingURL=main.bundle.js.map